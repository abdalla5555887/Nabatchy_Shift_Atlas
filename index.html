<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <title>Nabatchy_Shift_Atlas</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
            direction: rtl;
        }

        .container {
            width: 95%;
            background: white;
            padding: 10px;
            margin: 0 auto;
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¬Ø¯ÙˆÙ„ */
        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: auto;
            margin-bottom: 5px;
        }

        th, td {
            border: 1px solid #000;
            text-align: center;
            padding: 2px 4px;
            font-size: 11px; 
            vertical-align: middle;
            color: #000;
        }

        .shift-cell {
            white-space: nowrap;
            overflow: visible;
            cursor: pointer;
            transition: background 0.2s;
        }

        th {
            background-color: #eee;
            font-weight: bold;
            padding: 5px;
            white-space: nowrap;
        }

        .col-date, .col-day { width: 1%; white-space: nowrap; }
        
        /* ØªØ¸Ù„ÙŠÙ„ Ø§Ù„Ø®Ù„ÙŠØ© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© - Ù„ÙˆÙ† Ø£ØµÙØ± ÙØ§ØªØ­ ÙˆØ§Ø¶Ø­ */
        .selected-cell {
            background-color: #fff9c4 !important; /* Ø£ØµÙØ± ÙØ§ØªØ­ Ù„Ù„ØªÙ…ÙŠÙŠØ² */
            outline: 2px solid #fbc02d;
            font-weight: bold;
        }

        h1 {
            text-align: center;
            font-size: 18px;
            margin: 0 0 15px 0;
            text-decoration: underline;
            font-weight: bold;
        }

        /* Ø§Ù„ØªÙˆÙ‚ÙŠØ¹Ø§Øª ÙˆØ§Ù„Ø£ÙƒÙˆØ§Ø¯ */
        .signatures-wrapper { display: flex; justify-content: space-between; margin-top: 20px; padding: 0 20px; font-size: 12px; font-weight: bold; }
        .sig-block { text-align: center; min-width: 150px; }
        .sig-block input { border: none; text-align: center; font-family: inherit; font-weight: bold; font-size: 12px; width: 100%; background: transparent; margin-top: 5px; }
        .codes-list { text-align: right; margin-top: 10px; margin-right: 5px; font-size: 11px; font-weight: bold; }
        .code-row input { border: none; background: transparent; font-weight: bold; font-family: inherit; font-size: 11px; text-align: right; width: 300px; }

        /* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… */
        .controls-panel {
            margin-top: 20px;
            padding: 15px;
            background: #e9ecef;
            border: 1px solid #ced4da;
            position: sticky;
            bottom: 0;
            z-index: 100;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
        }
        
        .quick-select-box {
            background: #fff;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .worker-btn { padding: 4px 8px; margin: 2px; cursor: pointer; font-size: 12px; border: 1px solid #999; border-radius: 3px; background: #fff;}
        .worker-btn.active { background: #333; color: #fff; border-color: #000; }
        .worker-btn:hover { background: #ddd; }

        @media print {
            @page { size: A4 landscape; margin: 5mm; }
            body { padding: 0; margin: 0; background: white; zoom: 85%; -webkit-print-color-adjust: exact; }
            .container { padding: 0; width: 100%; max-width: none; }
            .controls-panel, .setup-bar { display: none !important; }
            th, td { border: 1px solid #000 !important; font-size: 9pt !important; padding: 2px !important; }
            th { background-color: #eee !important; }
            .selected-cell { background-color: transparent !important; outline: none; }
        }
    </style>
</head>
<body>

<div class="container">
    <h1 id="tableTitle">Ø¬Ø¯ÙˆÙ„ Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¦ÙŠÙŠÙ† ÙˆØ§Ù„ÙÙ†ÙŠÙŠÙ† Ø¨Ø¨Ù†Ùƒ Ø§Ù„Ø¯Ù… Ø¹Ù† Ø´Ù‡Ø± ...</h1>

    <div class="setup-bar" style="text-align:center; padding:10px; background:#f8f9fa; margin-bottom:10px; border: 1px solid #ddd;">
        <label>Ø§Ù„Ø´Ù‡Ø±: </label>
        <select id="monthSelect" onchange="generateTable()">
            <option value="1">ÙŠÙ†Ø§ÙŠØ±</option><option value="2">ÙØ¨Ø±Ø§ÙŠØ±</option><option value="3">Ù…Ø§Ø±Ø³</option>
            <option value="4">Ø£Ø¨Ø±ÙŠÙ„</option><option value="5">Ù…Ø§ÙŠÙˆ</option><option value="6">ÙŠÙˆÙ†ÙŠÙˆ</option>
            <option value="7">ÙŠÙˆÙ„ÙŠÙˆ</option><option value="8">Ø£ØºØ³Ø·Ø³</option><option value="9">Ø³Ø¨ØªÙ…Ø¨Ø±</option>
            <option value="10">Ø£ÙƒØªÙˆØ¨Ø±</option><option value="11">Ù†ÙˆÙÙ…Ø¨Ø±</option><option value="12">Ø¯ÙŠØ³Ù…Ø¨Ø±</option>
        </select>
        <label> Ø§Ù„Ø³Ù†Ø©: </label>
        <input type="number" id="yearSelect" value="2026" style="width:60px;" onchange="generateTable()">
        <button onclick="window.print()" style="background:#007bff; color:white; border:none; padding:5px 15px; cursor:pointer; margin-right:10px; font-weight:bold;">Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„</button>
    </div>

    <table id="mainTable">
        <thead>
            <tr>
                <th class="col-date">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                <th class="col-day">Ø§Ù„ÙŠÙˆÙ…</th>
                <th>8 ØµØ¨Ø§Ø­Ø§Ù‹ - 2 Ø¸Ù‡Ø±Ø§Ù‹</th>
                <th>2 Ø¸Ù‡Ø±Ø§Ù‹ - 8 Ù…Ø³Ø§Ø¡Ù‹</th>
                <th>8 Ù…Ø³Ø§Ø¡Ù‹ - 8 ØµØ¨Ø§Ø­Ø§Ù‹</th>
            </tr>
        </thead>
        <tbody id="tableBody"></tbody>
    </table>

    <div class="codes-list">
        <div class="code-row"><input type="text" value="Ø§Ù„Ø§Ø¡ Ø¹Ø¨Ø¯Ø§Ù„Ù†Ø¨ÙŠ  1111"></div>
        <div class="code-row"><input type="text" value="Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ø­Ù…Ø¯  1111"></div>
        <div class="code-row"><input type="text" value="Ø­Ø³Ø§Ù… Ø­Ø³Ù†  1111"></div>
        <div class="code-row"><input type="text" value="Ø­Ø³Ø§Ù… Ø­Ø³Ù†  1111"></div>
        <div class="code-row"><input type="text" value="Ø­Ø³Ø§Ù… Ø­Ø³Ù† 1111"></div>
    </div>

    <div class="signatures-wrapper">
        <div class="sig-block"><div>Ù…Ø³Ø¤ÙˆÙ„ Ø¨Ù†Ùƒ Ø§Ù„Ø¯Ù…</div><input type="text" value="Ø¯/ Ù…Ù‡Ø§ ÙØªÙˆØ­ ÙˆØ§Ù„ÙŠ"></div>
        <div class="sig-block"><div>Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰</div><input type="text" value="Ø¯/ Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­ Ù‚Ø§Ø³Ù…"></div>
    </div>

    <div class="controls-panel">
        <div class="quick-select-box">
            <strong style="color:#007bff; font-size:14px;">ğŸ” ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†Ø¨Ø·Ø´ÙŠØ©:</strong>
            
            <div style="display:flex; align-items:center;">
                <label>Ø§Ù„ÙŠÙˆÙ…:</label>
                <input type="number" id="quickDay" min="1" max="31" style="width:50px; text-align:center; margin:0 5px; font-weight:bold;" placeholder="1">
            </div>
            
            <div style="display:flex; align-items:center;">
                <label>Ø§Ù„ÙØªØ±Ø©:</label>
                <select id="quickShift" style="padding: 2px; margin:0 5px;">
                    <option value="2">8 ØµØ¨Ø§Ø­Ø§Ù‹ - 2 Ø¸Ù‡Ø±Ø§Ù‹</option>
                    <option value="3">2 Ø¸Ù‡Ø±Ø§Ù‹ - 8 Ù…Ø³Ø§Ø¡Ù‹</option>
                    <option value="4">8 Ù…Ø³Ø§Ø¡Ù‹ - 8 ØµØ¨Ø§Ø­Ø§Ù‹</option>
                </select>
            </div>

            <button type="button" onclick="manualSelect()" style="cursor:pointer; background: #007bff; color: white; border: none; padding: 5px 15px; border-radius:3px; font-weight:bold;">ØªØ­Ø¯ÙŠØ¯ ÙˆØªØ¸Ù„ÙŠÙ„</button>
        </div>

        <div style="margin-bottom:5px; font-weight:bold;">Ø§Ø®ØªØ± Ø§Ù„Ø£Ø³Ù…Ø§Ø¡:</div>
        <div id="palette" style="margin-bottom:10px;"></div>
        
        <div style="border-top:1px solid #ccc; padding-top:10px;">
            <input type="text" id="manualInput" placeholder="Ø§Ø³Ù… Ø¥Ø¶Ø§ÙÙŠ ÙŠØ¯ÙˆÙŠ..." style="padding:5px; width: 200px;">
            <button onclick="applyToCell()" style="cursor:pointer; background: green; color: white; border: none; padding: 5px 10px;">Ø­ÙØ¸ ÙÙŠ Ø§Ù„Ø®Ù„ÙŠØ©</button>
            <button onclick="clearCell()" style="cursor:pointer; background: red; color: white; border: none; padding: 5px 10px;">Ù…Ø³Ø­ Ø§Ù„Ø®Ù„ÙŠØ©</button>
        </div>
    </div>
</div>

<script>
    const workers = ["Ø®Ø§Ù„Ø¯ Ù‚Ø§Ø³Ù…", "Ù†Ø±Ù…ÙŠÙ† Ø·Ø§Ø±Ù‚", "Ø¬ÙŠÙ‡Ø§Ù† Ù†ØµØ±", "Ø¨Ø³Ù…Ø© Ù…Ø­Ù…Ø¯", "Ø§Ù„Ø§Ø¡ Ø¹Ø¨Ø¯ Ø§Ù„Ù†Ø¨ÙŠ", "Ø§Ù„Ø§Ø¡ Ù‚Ø§Ø³Ù…", "Ù…Ù‡Ø§ ÙˆØ§Ù„ÙŠ", "Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ Ø§Ø­Ù…Ø¯", "Ø§Ø³Ù…Ø§Ø¹ÙŠÙ„ Ø§Ù„Ø¹Ù…Ø§ÙˆÙŠ", "Ø§Ø­Ù…Ø¯ Ù…Ø­Ù…ÙˆØ¯", "Ø­Ø³Ø§Ù… Ø­Ø³Ù†", "ÙˆÙØ§Ø¡ Ø§Ù„Ù†Ù…Ø±", "Ø§Ø­Ù…Ø¯ Ø§Ù„Ø­Ø³ÙŠÙ†ÙŠ"];
    let selectedNames = [];
    let activeCell = null;

    function init() {
        // Ø¥Ù†Ø´Ø§Ø¡ Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ø³Ù…Ø§Ø¡
        const p = document.getElementById('palette');
        p.innerHTML = '';
        workers.forEach(name => {
            const btn = document.createElement('button');
            btn.className = 'worker-btn';
            btn.textContent = name;
            btn.onclick = () => {
                if (selectedNames.includes(name)) { 
                    selectedNames = selectedNames.filter(n => n !== name); 
                    btn.classList.remove('active'); 
                } else { 
                    selectedNames.push(name); 
                    btn.classList.add('active'); 
                }
            };
            p.appendChild(btn);
        });
        
        // Ø¶Ø¨Ø· Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠ
        const today = new Date();
        document.getElementById('monthSelect').value = today.getMonth() + 1;
        document.getElementById('yearSelect').value = today.getFullYear();
        
        generateTable();
        
        // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter ÙÙŠ Ø­Ù‚Ù„ Ø§Ù„ÙŠÙˆÙ…
        document.getElementById('quickDay').addEventListener("keypress", function(event) {
            if (event.key === "Enter") { manualSelect(); }
        });
    }

    function generateTable() {
        const month = parseInt(document.getElementById('monthSelect').value);
        const year = parseInt(document.getElementById('yearSelect').value);
        const tbody = document.getElementById('tableBody');
        const monthText = document.getElementById('monthSelect').options[month-1].text;
        
        document.getElementById('tableTitle').textContent = `Ø¬Ø¯ÙˆÙ„ Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¦ÙŠÙŠÙ† ÙˆØ§Ù„ÙÙ†ÙŠÙŠÙ† Ø¨Ø¨Ù†Ùƒ Ø§Ù„Ø¯Ù… Ø¹Ù† Ø´Ù‡Ø± ${monthText} ${year}`;
        tbody.innerHTML = '';
        
        const daysInMonth = new Date(year, month, 0).getDate();
        const arabicDays = ["Ø§Ù„Ø£Ø­Ø¯", "Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†", "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡", "Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡", "Ø§Ù„Ø®Ù…ÙŠØ³", "Ø§Ù„Ø¬Ù…Ø¹Ø©", "Ø§Ù„Ø³Ø¨Øª"];

        for (let d = 1; d <= daysInMonth; d++) {
            const dateObj = new Date(year, month - 1, d);
            const row = document.createElement('tr');
            if (dateObj.getDay() === 5) row.style.backgroundColor = "#f2f2f2"; 
            
            row.innerHTML = `
                <td>${d}</td>
                <td style="font-weight:bold;">${arabicDays[dateObj.getDay()]}</td>
                <td class="shift-cell" onclick="selectCell(this)"></td>
                <td class="shift-cell" onclick="selectCell(this)"></td>
                <td class="shift-cell" onclick="selectCell(this)"></td>
            `;
            tbody.appendChild(row);
        }
        
        document.getElementById('quickDay').max = daysInMonth;
    }

    function selectCell(cell) { 
        // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªØ¸Ù„ÙŠÙ„ Ø§Ù„Ù‚Ø¯ÙŠÙ…
        if (activeCell) activeCell.classList.remove('selected-cell'); 
        
        activeCell = cell; 
        cell.classList.add('selected-cell'); 
        
        // ØªØ­Ø¯ÙŠØ« Ø£Ø±Ù‚Ø§Ù… Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ù„ØªØ¹ÙƒØ³ Ù…Ø§ ØªÙ… Ø§Ø®ØªÙŠØ§Ø±Ù‡
        if(cell.parentElement) {
            const dayNum = cell.parentElement.cells[0].textContent;
            const shiftIdx = cell.cellIndex;
            document.getElementById('quickDay').value = dayNum;
            document.getElementById('quickShift').value = shiftIdx;
        }
    }

    // Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙŠØ¯ÙˆÙŠ (Ø§Ù„Ù…ØµØ­Ø­Ø©)
    function manualSelect() {
        const dayVal = document.getElementById('quickDay').value;
        const shiftCol = parseInt(document.getElementById('quickShift').value);
        
        if (!dayVal) { alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ø±Ù‚Ù… Ø§Ù„ÙŠÙˆÙ…"); return; }
        
        const dayNum = parseInt(dayVal);
        const tbody = document.getElementById('tableBody');
        
        // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„ÙŠÙˆÙ… Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„
        if (dayNum < 1 || dayNum > tbody.rows.length) {
            alert("Ø±Ù‚Ù… Ø§Ù„ÙŠÙˆÙ… ØºÙŠØ± ØµØ­ÙŠØ­ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±");
            return;
        }

        // Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ØµÙ ÙˆØ§Ù„Ø®Ù„ÙŠØ©
        // Ø§Ù„Ù…ØµÙÙˆÙØ© ØªØ¨Ø¯Ø£ Ù…Ù† 0ØŒ Ù„Ø°Ø§ Ø§Ù„ÙŠÙˆÙ… 1 Ù‡Ùˆ Ø§Ù„ØµÙ 0
        const targetRow = tbody.rows[dayNum - 1]; 
        
        if (targetRow) {
            const targetCell = targetRow.cells[shiftCol];
            if (targetCell) {
                // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø®Ù„ÙŠØ© Ù„ØªÙØ¹ÙŠÙ„ ÙƒÙ„ Ø´ÙŠØ¡
                targetCell.click();
                // Ø§Ù„ØªÙ…Ø±ÙŠØ± Ù„Ù„Ø´Ø§Ø´Ø© Ù„ØªØ¸Ù‡Ø± Ø§Ù„Ø®Ù„ÙŠØ©
                targetCell.scrollIntoView({behavior: "smooth", block: "center"});
            }
        }
    }

    function applyToCell() {
        if (!activeCell) return alert("âš ï¸ Ø§Ø®ØªØ± Ø®Ù„ÙŠØ© Ø£ÙˆÙ„Ø§Ù‹! \nØ§Ø¶ØºØ· Ø¹Ù„Ù‰ 'ØªØ­Ø¯ÙŠØ¯ ÙˆØªØ¸Ù„ÙŠÙ„' Ø£Ùˆ Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ø¯ÙˆÙ„.");
        
        const manual = document.getElementById('manualInput').value.trim();
        let final = [...selectedNames];
        if (manual) final.push(manual);
        
        activeCell.textContent = final.join(' - ');
        
        // ØªÙ†Ø¸ÙŠÙ
        selectedNames = [];
        document.querySelectorAll('.worker-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('manualInput').value = '';
        activeCell.classList.remove('selected-cell');
        activeCell = null;
    }

    function clearCell() { 
        if (activeCell) {
            activeCell.textContent = ''; 
            activeCell.classList.remove('selected-cell');
            activeCell = null;
        } else {
            alert("Ø§Ø®ØªØ± Ø®Ù„ÙŠØ© Ù„Ù…Ø³Ø­Ù‡Ø§");
        }
    }

    window.onload = init;
</script>
</body>
</html>